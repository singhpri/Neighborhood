<!DOCTYPE html>
<html>
 <head>
   <script type='text/javascript' src='bower_components/knockout/dist/knockout.js'></script>
   <style type="text/css">
     html, body { height: 100%; margin: 0; padding: 0; }
     #map {
       bottom: 0px;
       height: 100%;
       left: 300px;
       position: absolute;
       right: 0px;
    }
    .container {
      height: 100%;
      position: relative;
    }
    h1 {
      color: gray;
      font-size: 22px;
      margin: 0 0 10px 0;
      text-align: left;
    }
    </style>
 </head>
 <body>
   <div class="container">
   <h1>Preschools</h1>
   <div id="map"></div>
   <input type="text" id="myInput" placeholder="Search for names..">
   <button data-bind="click: mySchools">Filter</button>
   <ul data-bind="foreach: school">
     <li data-bind="visible: flag()">
       <span data-bind="text: name"></span>
   </li>
   </ul>
 </div>

   <script>
   var positions = [
     {title: 'Bright Horizons', location: {lat: 47.639159, lng: -122.142314}},
     {title: 'Childtime of Redmond', location: {lat: 47.648688, lng: -122.129937}},
     {title: 'La Petite Academy', location: {lat: 47.679538, lng: -122.126500}},
     {title: 'Overlake KinderCare', location: {lat: 47.628773, lng: -122.137012}},
     {title: "Anny's Care", location: {lat: 47.661411, lng: -122.142154}},
     {title: "The Goddard School", location: {lat: 47.692930, lng: -122.036428}},
     {title: "Education Hill Learning Center", location: {lat: 47.693148, lng: -122.103015}}
   ]
   function initMap() {

        var redmond = {lat: 47.673988, lng: -122.121513};
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 12,
          center: redmond
        });
        var markers = [];

        for(var i = 0; i < positions.length; i++){
          var marker = new google.maps.Marker({
            position: positions[i].location,
            title: positions[i].title,
            map: map
          });
          markers.push(marker);
      }
    }
    function schoolList(name, flag) {
      var self = this;
      self.name = name;
      self.flag = ko.observable(flag);
    }

      function listViewModel() {
        var self = this;
        self.school = ko.observableArray([]);
        for(var i = 0; i < positions.length; i++){
          self.school.push(new schoolList (positions[i].title, true));
      }

      self.mySchools = function(){
        var input = document.getElementById('myInput');
        var filter = input.value.toLowerCase();
        for(var i = 0; i < self.school().length; i++){
          if(self.school()[i].name.toLowerCase().indexOf(filter) > -1){
            self.school()[i].flag() = true;
          }
          else {
            self.school()[i].flag() = false;
        }
      }
    }

    }
      ko.applyBindings(new listViewModel());
  </script>
   <script async defer
       src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhEB5wCvm-NdmMI_G53GoFvtVGnzZe-0A&v=3&callback=initMap">
  </script>

 </body>
 </html>
